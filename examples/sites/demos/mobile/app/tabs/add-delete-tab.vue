<template>
  <div class="demo-tabs">
    <div class="demo-tabs-item">
      <p>1. 动态增加页签</p>
      <tiny-tabs v-model="activeName1" :with-add="true" @add="handleAdd">
        <tiny-tab-item :key="item.name" v-for="item in tabsData" :title="item.title" :name="item.name">
          {{ item.content }}
        </tiny-tab-item>
      </tiny-tabs>
    </div>

    <div class="demo-tabs-item">
      <p>2. 动态删除页签</p>
      <tiny-tabs v-model="activeName2" :with-close="true" @close="handleClose">
        <tiny-tab-item :key="item.name" v-for="item in tabsData" :title="item.title" :name="item.name">
          {{ item.content }}
        </tiny-tab-item>
      </tiny-tabs>
    </div>
  </div>
</template>

<script setup>
import { ref } from 'vue'
import { TinyTabs, TinyTabItem } from '@opentiny/vue-mobile'

const tabsData = ref([
  {
    title: '标签 1',
    name: '1',
    content: '内容 1'
  },
  {
    title: '标签 2',
    name: '2',
    content: '内容 2'
  },
  {
    title: '标签 3',
    name: '3',
    content: '内容 3'
  },
  {
    title: '标签 4',
    name: '4',
    content: '内容 4'
  }
])
const activeName1 = ref('1')
const activeName2 = ref('2')
const tabIndex = ref(5)

function handleAdd() {
  tabsData.value.push({
    title: `标签 ${tabIndex.value}`,
    name: String(tabIndex.value),
    content: '动态增加页签'
  })
  tabIndex.value++
}

function handleClose(name) {
  let index = 0
  tabsData.value.map((tab, inx) => {
    if (tab.name === name) {
      index = inx
    }
  })
  tabsData.value.splice(index, 1)
}
</script>

<style scoped>
.demo-tabs {
  height: 100%;
  background: #f5f5f5;
}
.demo-tabs-item {
  padding: 20px;
  margin-bottom: 48px;
  background: #fff;
}
</style>
